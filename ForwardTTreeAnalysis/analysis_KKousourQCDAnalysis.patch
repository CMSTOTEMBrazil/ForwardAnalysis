diff -Nru -X diff_exclude /afs/cern.ch/user/a/antoniov/storage2/Workspace/Analysis/UserCode/KKousour/QCDAnalysis/plugins/BuildFile.xml QCDAnalysis/plugins/BuildFile.xml
--- /afs/cern.ch/user/a/antoniov/storage2/Workspace/Analysis/UserCode/KKousour/QCDAnalysis/plugins/BuildFile.xml	2011-04-12 19:18:36.000000000 +0200
+++ QCDAnalysis/plugins/BuildFile.xml	2011-09-10 19:16:21.000000000 +0200
@@ -21,6 +21,7 @@
 <use   name="CondFormats/L1TObjects"/>
 <use   name="CondFormats/DataRecord"/>
 <use   name="KKousour/QCDAnalysis"/>
+<use   name="ForwardAnalysis/ForwardTTreeAnalysis"/>
 <flags   EDM_PLUGIN="1"/>
 </library>
 
diff -Nru -X diff_exclude /afs/cern.ch/user/a/antoniov/storage2/Workspace/Analysis/UserCode/KKousour/QCDAnalysis/plugins/ProcessedTreeProducer.cc QCDAnalysis/plugins/ProcessedTreeProducer.cc
--- /afs/cern.ch/user/a/antoniov/storage2/Workspace/Analysis/UserCode/KKousour/QCDAnalysis/plugins/ProcessedTreeProducer.cc	2011-09-10 19:25:53.000000000 +0200
+++ QCDAnalysis/plugins/ProcessedTreeProducer.cc	2011-09-10 22:00:46.000000000 +0200
@@ -45,7 +45,14 @@
 #include "CondFormats/JetMETObjects/interface/JetCorrectorParameters.h"
 #include "JetMETCorrections/Objects/interface/JetCorrectionsRecord.h"
 
-ProcessedTreeProducer::ProcessedTreeProducer(edm::ParameterSet const& cfg) 
+//==========
+#include "ForwardAnalysis/ForwardTTreeAnalysis/interface/DiffractiveAnalysis.h"
+#include "ForwardAnalysis/ForwardTTreeAnalysis/interface/DiffractiveEvent.h"
+using namespace diffractiveAnalysis;
+//==========
+
+ProcessedTreeProducer::ProcessedTreeProducer(edm::ParameterSet const& cfg):
+  diffractiveAnalysis_( cfg.getParameter<edm::ParameterSet>("diffractiveAnalysis") ) 
 {
   mPFJECservice      = cfg.getParameter<std::string>               ("pfjecService");
   mCaloJECservice    = cfg.getParameter<std::string>               ("calojecService");
@@ -83,8 +90,12 @@
 void ProcessedTreeProducer::beginJob() 
 {
   mTree = fs->make<TTree>("ProcessedTree","ProcessedTree");
+  //========== 
   mEvent = new QCDEvent();
-  mTree->Branch("events","QCDEvent",&mEvent);
+  mDiffEvent = new DiffractiveEvent(); 
+  mTree->Branch("QCDAnalysis","QCDEvent",&mEvent);
+  mTree->Branch("DiffractiveAnalysis","DiffractiveEvent",&mDiffEvent);
+  //========== 
   mTriggerNamesHisto = fs->make<TH1F>("TriggerNames","TriggerNames",1,0,1);
   mTriggerNamesHisto->SetBit(TH1::kCanRebin);
   for(unsigned i=0;i<triggerNames_.size();i++)
@@ -124,6 +135,9 @@
          << " config extraction failure with process name "
          << processName_ << endl;
   }
+  //==========
+  diffractiveAnalysis_.setBeginRun(iRun,iSetup);
+  //==========
 }
 //////////////////////////////////////////////////////////////////////////////////////////
 void ProcessedTreeProducer::analyze(edm::Event const& event, edm::EventSetup const& iSetup) 
@@ -512,6 +526,9 @@
   mEvent->setPFMET(mPFMet);
   mEvent->setL1Obj(mL1Objects);
   mEvent->setHLTObj(mHLTObjects);
+  //==========
+  diffractiveAnalysis_.fillEventData(*mDiffEvent,event,iSetup);
+  //==========
   if ((mEvent->nPFJets() >= (unsigned)mMinNPFJets) && (mEvent->nCaloJets() >= (unsigned)mMinNCaloJets)) {
     if ((mEvent->pfmjjcor(0) >= mMinJJMass) || (mEvent->calomjjcor(0) >= mMinJJMass) || (mEvent->fatmjjcor(0) >= mMinJJMass)) {
       mTree->Fill();
diff -Nru -X diff_exclude /afs/cern.ch/user/a/antoniov/storage2/Workspace/Analysis/UserCode/KKousour/QCDAnalysis/plugins/ProcessedTreeProducer.h QCDAnalysis/plugins/ProcessedTreeProducer.h
--- /afs/cern.ch/user/a/antoniov/storage2/Workspace/Analysis/UserCode/KKousour/QCDAnalysis/plugins/ProcessedTreeProducer.h	2011-07-06 09:26:14.000000000 +0200
+++ QCDAnalysis/plugins/ProcessedTreeProducer.h	2011-09-10 19:04:52.000000000 +0200
@@ -18,6 +18,11 @@
 #include "FWCore/ServiceRegistry/interface/Service.h"
 #include "CommonTools/UtilAlgos/interface/TFileService.h"
 
+//==========
+#include "ForwardAnalysis/ForwardTTreeAnalysis/interface/DiffractiveAnalysis.h"
+class DiffractiveEvent;
+//==========
+
 using namespace edm;
 using namespace reco;
 using namespace std;
@@ -82,6 +87,10 @@
     TH1F *mTriggerPassHisto,*mTriggerNamesHisto; 
     //---- TREE variables --------
     QCDEvent *mEvent;
+    //==========
+    diffractiveAnalysis::DiffractiveAnalysis diffractiveAnalysis_;
+    DiffractiveEvent *mDiffEvent;
+    //==========
 };
 
 #endif
